# Техническое задание на разработку мобильных приложений "HealApp"

## 1. Общая информация

### 1.1. Цель проекта

Создать комплексную мобильную экосистему для организации ухода за пожилыми людьми и людьми с ограниченными возможностями, объединяющую:
- Поиск и заказ квалиф  ицированного персонала по уходу (сиделки, медсестры)
- Заказ расходных материалов для ухода
- Ведение цифрового дневника состояния подопечного
- Управление задачами ухода через маршрутный лист
- Контроль качества ухода и динамики состояния здоровья

### 1.2. Платформа

- **iOS** (версия 13.0+)
- **Android** (версия 8.0+)
- **Технологии:** 

### 1.3. Текущий статус

- Требуется разработка двух мобильных приложений с полным функционалом

### 1.4. Общая концепция экосистемы

**HealApp** состоит из двух мобильных приложений, работающих в единой экосистеме:

1. **Мобильное приложение для клиентов** (iOS/Android)
   - Заказ сиделок и мед персонала через сервис Heal Link
   - Заказ уходовых боксов и расходных материалов через сервис Vita Box
   - Ведение дневника подопечного
   - Создание маршрутного листа для сиделок

2. **Мобильное приложение для специалистов и организаций** (iOS/Android)
   - **Для частных специалистов:**
     - Получение и управление заказами от клиентов
     - Заполнение профиля и календаря работы
     - Заполнение дневника подопечного
     - Реферальная программа и кэшбек за покупки уходовых средств/боксов и за покупки клиентов которые были приглашены по реферальной системе этим специалистом
   - **Для организаций (патронажные агентства и пансионаты):**
     - При регистрации выбирается тип организации (Пансионат / Патронажное агентство)
     - Управление сотрудниками
     - Назначение задач через маршрутный лист
     - Доступ к дневникам подопечных
     - Контроль выполнения задач
     - Общее расписание (для пансионатов)

### 1.5. Основные сервисы экосистемы

#### Heal Link
Сервис поиска и заказа сиделок и мед персонала по уходу за здоровьем на дому (аналогично Яндекс Такси):
- Почасовая забота и уход (приходящая сиделка)
- Уход с проживанием (сиделка на постоянной основе)
- Вызов медсестры на дом
- Перевозка лежачих (специализированное такси для маломобильных людей)

**Принцип работы:** Клиент создает карточку подопечного, указывает требуемые услуги, даты и время посещений. Система автоматически подбирает подходящих специалистов на основе совпадения параметров (дата/время, опыт, навыки, районы работы). Клиент выбирает специалиста, оплачивает услугу и средства резервируются на его балансе в личном кабинете, после окончания работы специалиста, средства переводятся специалисту на баланс личного аккаунта.

#### Vita Box
Сервис заказа уходовых боксов со всеми расходными материалами для лежачих подопечных:
- Готовые наборы с подгузниками разных размеров (M, L, XL)
- Дополнительные средства от пролежней (+500 руб.)
- Возможность добавления дополнительных товаров для ухода
- Базовая стоимость: 12 000 руб. (без средств от пролежней)
- Доставка в течение 2 часов

#### Дневник подопечного и маршрутный лист
Централизованный цифровой журнал для фиксации состояния показателей здоровья и ухода за подопечным:
- 4 блока показателей: Параметры ухода (9), Физикальные параметры (6), Выделение мочи и кала (2), Тягостные симптомы (8)
- Карточки подопечных с личными данными, диагнозами, требуемыми услугами
- Мультимедиа (фото, видео, голосовые заметки)
- Графики динамики показателей
- Экспорт отчётов (PDF/CSV)
- Закрепленные показатели с таймерами и оповещениями (отображаются на главном экране дневника)
- Маршрутный лист с задачами для сиделок (вертикальный список, drag and drop)
- Синхронизация данных между приложениями специалистов/организаций/клиентов в реальном времени

### 1.6. Язык интерфейса

- **Язык:** Русский

---

## 2. Основные функции

### 2.1. Мобильное приложение для клиентов (iOS/Android)

#### 2.1.1. Регистрация и авторизация

**Регистрация:**
- Регистрация по имени, номеру телефона и паролю
- Проверка телефона: отправка кода подтверждения на номер телефона
- Ввод кода подтверждения для верификации телефона
- Установка пароля
- После регистрации клиент может использовать приложение
- Добавление счёта СБП (Система быстрых платежей) при первом заказе
- Привязка Сбер ID (опционально)

**Авторизация:**
- Вход по номеру телефона и паролю
- Восстановление пароля через SMS

#### 2.1.2. Главный экран

**Элементы экрана:**

1. **Верхняя панель:**
   - Переход в профиль
   - Название компании "HealApp"
   - Слоган "Забота о Вас — каждый час."

2. **Баннер с напоминанием (опционально):**
   - Показывается, если у клиента есть закрепленные показатели с таймером в дневнике подопечного
   - Если нет закрепленных показателей — показывается предложение о добавлении
   - Отображает информацию: "Измерить артериальное давление через: 00:38" (таймер обратного отсчета с уведомлением по его истечению)
   - Фото/имя подопечного (например, "Иван В.В.")
   - Действие "Записать"
   - Индикатор карусели (если несколько напоминаний)

3. **Основной блок - сетка из 4 элементов (2x2):**
   
   **Верхний ряд:**
   - "Выбрать сиделку" — переход к сервису Heal Link
   - "Дневник подопечного" — переход к дневнику
   
   **Нижний ряд:**
   - "Маркет" — переход к сервису Vita Box
   - "Посещения" — переход к списку предстоящих посещений (отображается количество)

4. **Нижний блок:**
   - "Такси для маломобильных" — переход к заказу специализированного такси

#### 2.1.3. Сервис Heal Link

**Выбор типа услуги:**
После нажатия на "Выбрать сиделку" отображаются 4 варианта:
1. Почасовая забота и уход (приходящая сиделка)
2. Уход с проживанием (сиделка на постоянной основе)
3. Вызов медсестры на дом
4. Перевозка лежачих (специализированное такси)

**Создание/выбор карточки подопечного:**

**Интерфейс выбора карточки:**
- Отображение существующих карточек с ФИО
- Создание новой карточки
- Возможность выбрать существующую карточку

**Для заказа сиделки (почасовая/с проживанием) - форма создания карточки подопечного:**

**Примечание:** Клиент заполняет карточку подопечного с характеристиками человека, за которым требуется уход. Эти данные используются для подбора подходящей сиделки.

**Поля карточки подопечного:**
- ФИО подопечного (обязательно)
- Возраст подопечного
- Пол подопечного
- Адрес для заказа персонала (обязательно)
- Есть ли животные в доме (да/нет)
- Заболевания подопечного (множественный выбор): Деменция, Болезнь Паркинсона, Болезнь Альцгеймера, Инсульт, Инфаркт, Перелом шейки бедра, Свой вариант
- Мобильность подопечного (один вариант): Лежит, Сидит, Ходит
- Требуемые услуги (множественный выбор): Растирание конечностей, Развивающие игры, Интересное времяпрепровождение, Проследить за принятием лекарств, Помощь в кормлении, Мерять давление, Уборка, Стирка, Готовка, Гигиенический уход (помощь в смене памперсов, абсорбирующее бельё, использование и очистка судна, кресло туалета)
- Особые пожелания (текстовое поле)
- Календарь выбора дат и времени посещения (выпадающий список для выбора дат, выбор времени прихода специалиста для каждой даты)
- Выбор типа специалиста: Компаньон-волонтёр / Сиделка

**Логика выбора специалиста:**
- Если выбраны услуги, требующие профессионального ухода (гигиенический уход, помощь в кормлении, проследить за принятием лекарств, мерять давление) → нельзя выбрать компаньона-волонтёра
- Если выбраны только услуги для компаньона (развивающие игры, интересное времяпрепровождение, растирание конечностей) → можно выбрать и сиделку или волонтёра

**Для заказа медсестры - форма создания карточки подопечного:**

**Примечание:** Клиент заполняет карточку подопечного с медицинскими характеристиками для вызова медсестры.

**Поля карточки подопечного:**
- ФИО подопечного (обязательно)
- Текущие болезни подопечного
- Хронические болезни подопечного
- Адрес вызова медсестры (обязательно)
- Есть ли домашние животные (да/нет)
- Требуемые услуги (множественный выбор): Забор крови на анализы, Забор кала/мочи на анализы, Укол, Капельница, Осмотр
- Календарь выбора даты и времени посещения

**Поиск специалистов:**

**Алгоритм подбора:**
- Система сопоставляет параметры клиента и специалиста
- **Приоритет 1:** Совпадение даты и времени работы (самый важный фактор)
- **Приоритет 2:** Совпадение районов работы
- **Приоритет 3:** Опыт работы с нужными заболеваниями
- **Приоритет 4:** Опыт работы с лежачими (если требуется)
- **Приоритет 5:** Общий опыт работы
- **Приоритет 6:** Рейтинг специалиста
- Специалисты отображаются в порядке релевантности

**Отображение результатов:**
- Карточки специалистов в порядке релевантности
- На карточке: Фото, Имя, Опыт работы (лет), Стоимость (стоимость часа/месяца/выезда)

**Профиль специалиста:**
- Фото специалиста, Имя, Опыт работы
- Рейтинг (5-звёздочная система)
- Оценки по параметрам: Вежливость, Чистоплотность, Аккуратность (количество оценок)
- Скролл со скиллами: Что умеет специалист, С какими подопечными работал (диагнозы)
- Описание заказа: Что входит в час работы (для сиделок) / Список услуг (для медсестёр)
- Дополнительные услуги (оплачиваются отдельно): Список с ценами, Возможность выбора
- Итоговая сумма: Для почасовых (количество посещений × часы × стоимость часа + доп. услуги), Для сиделок с проживанием (месяцы × стоимость месяца + доп. услуги), Для медсестёр (стоимость выезда + доп. услуги)
- Оплата

**Оплата заказа:**

**Условие:** Клиент должен быть зарегистрирован в приложении. Если клиент не зарегистрирован, необходимо сначала пройти регистрацию (см. раздел 2.1.1).

**Процесс оплаты:**
1. После выбора специалиста и расчета итоговой суммы клиент переходит к оплате
2. Если счёт СБП не добавлен: форма добавления счёта СБП
3. Оплата через СБП
4. После успешной оплаты: Деньги резервируются на счёте клиента в личном кабинете
5. Деньги остаются на счету клиента до завершения заказа специалистом
6. Экран подтверждения: Заголовок "Успешно оплачено", Текст "В личном кабинете отслеживайте время посещений", Информация о заказе (описание, даты, время, специалист), Переход в чат со специалистом, Переход в личный кабинет

#### 2.1.4. Чат со специалистом

**Основной функционал:**
- Обмен текстовыми сообщениями
- Возможность задать вопросы специалисту

**Дополнительные функции (для сиделок почасовых/с проживанием):**

**Меню дополнительных действий:**
1. Дозаказать услугу
2. Дозаказать часы
3. Запросить заполнение дневника

**Дозаказать часы:**
- Форма: Выбор конкретного дня (из списка дней с активными заказами), Выбор дополнительных часов (числовое поле или слайдер), Автоматический расчет стоимости, Текст: "Мы отправим запрос на дополнительное время сиделке. Если сиделка откажется или не ответит в течение 10 минут, предложим сменщицу.", Отправка запроса
- Процесс:
  - Запрос отправляется сиделке
  - Сиделка видит сообщение: "Клиент хочет заказать дополнительные X часов работы за Y руб."
  - Кнопки у сиделки: "Согласиться" / "Отказаться"
  - Если сиделка отказалась:
    - Клиенту показывается: "Сиделка отказалась, предлагаем найти сменщицу"
    - Запуск поиска сменщицы
    - В чате появляется системное сообщение о запуске поиска сменщицы
    - Система автоматически ищет подходящих сменщиц
    - После подбора показывается предложение в чате с действиями: "Анкета", "Согласиться", "Отказать"
    - При согласии: сообщение о выборе сменщицы
    - При отказе: показывается следующий вариант сменщицы
  - Если сиделка согласилась или выбрана сменщица → окно оплаты дополнительных часов

**Дозаказать услугу:**
- Открывается список дополнительных услуг специалиста (из его профиля)
- Каждая услуга с указанием цены
- Возможность выбрать несколько услуг
- Отображение итоговой суммы
- Оплата дополнительных услуг (через СБП)
- После оплаты: "Успешно оплачено. Мы оповестили специалиста о новой задаче."
- В чате специалиста появляется сообщение: "Клиент оплатил дополнительную услугу(и): [список услуг]"

**Запросить заполнение дневника:**
- Запрос отправляется сиделке в чат
- Сиделка должна заполнить дневник подопечного
- После заполнения клиент получает краткий отчёт

**Начало работы специалиста:**
1. Специалист нажимает "Начать работу" в своём приложении
2. Клиенту приходит уведомление: "Специалист начал выполнение работы"
3. Клиент должен подтвердить начало работы
4. После подтверждения: Заказ переходит в статус "В работе", Деньги остаются на счету клиента до завершения заказа

**Завершение работы специалиста:**
1. Специалист нажимает "Завершить работу" в своём приложении
2. Клиенту приходит уведомление: "Специалист завершил выполнение работы"
3. Клиент должен подтвердить завершение работы
4. После подтверждения: Деньги списываются со счёта клиента, Деньги переводятся на счёт специалиста (счёт оказания услуг), Заказ переходит в статус "Завершен"

#### 2.1.5. Личный кабинет клиента

**Структура (для незарегистрированных):**
- Пустые поля
- Регистрация

**Структура (для зарегистрированных):**
- Имя и номер телефона (вверху экрана)
- **Блок "Предстоящие посещения":** Квадратики с датами посещений (календарный вид), При нажатии на дату → детальная информация о посещении
- **Блок "Карточки пациентов":** Список карточек подопечных с ФИО, Добавление новой карточки, Возможность изменить, добавить, убрать данные
- **Блок "Дневники подопечных":** Список дневников (привязанных к карточкам подопечных), Просмотр и заполнение информации и отчётов сиделками или самим клиентом, Синхронизация данных между приложениями в реальном времени, Доступ к маршрутному листу (создание задач для сиделки)
- **Блок "История заказов":** Список всех заказов (Heal Link и Vita Box), Детали каждого заказа, Статусы доставки (для Vita Box)
- **Блок "Подборки":** Товары, добавленные в избранное (для будущих заказов Vita Box), Возможность быстрого заказа
- **Блок "Где нас найти":** Ссылка на сайт, Ссылка на Telegram-канал
- Связь с поддержкой

**Детальная информация о посещении:**
- Заголовок: "Посещение для подопечного [Имя]"
- Дата и время посещения
- Текст: "К вам приедет [Тип специалиста]"
- Карточка специалиста: Фото, Имя, Опыт работы, Описание
- Оплаченные услуги (список)
- Переход в чат со специалистом
- Если есть сменщица: Карточка сменщицы (аналогично основному специалисту), Оплаченные услуги, Переход в чат со специалистом

**Настройки профиля:**
- **Изменить имя:** Форма с полем ввода имени, Сохранение изменений
- **Изменить/добавить почту:** Форма с полем ввода почты, Отправка кода подтверждения на почту, Поле ввода кода, Сохранение изменений
- **Изменить адрес:** Форма с выбором карточки подопечного (чей адрес), Поле ввода/изменения адреса, Сохранение изменений
- **Привязать Сбер ID:** Форма входа по Сбер ID
- **Уведомления:** Переключатели (Push-уведомления, Письма на почту, SMS)

**История заказов:**
- Список всех заказов (Heal Link и Vita Box)
- Фильтры по типу заказа
- Детали каждого заказа: Дата заказа, Тип услуги/товара, Специалист/товары, Сумма, Статус
- Для заказов Heal Link: ссылка на чат со специалистом
- Для заказов Vita Box: статус доставки, возможность оценки доставки

**Подборки (избранное):**
- Товары Vita Box, добавленные в избранное
- Возможность быстрого заказа из избранного
- Удаление из избранного

#### 2.1.6. Сервис Vita Box

**Каталог товаров:**
- Три варианта боксов: Vita Box для лежачих с памперсами M, Vita Box для лежачих с памперсами L, Vita Box для лежачих с памперсами XL

**Страница товара:**
- Содержимое бокса: Рукавицы пенообразующие, Пенка для мытья и ухода за телом, Шампунь-пенка для мытья волос, Салфетки сухие, Салфетки влажные, Крем для использования после подгузников с оксидом цинка, Крем для тела с аргинином, Перчатки одноразовые, Присыпка, Пеленки, Подгузники (размер указан в названии бокса)
- Дополнительные опции: Чекбокс "Добавить средства от пролежней" (+500 руб.)
- Цена: Базовая стоимость 10 000 руб. (без средств от пролежней), С средствами от пролежней: 12 500 руб.
- Добавление в корзину

**Оформление заказа:**
- Форма: Состав заказа, Возможность добавить счёт СБП, Цена, Оплата, Блок "Что добавить к заказу" (дополнительные товары)
- **Условие:** Клиент должен быть зарегистрирован в приложении. Если клиент не зарегистрирован, необходимо сначала пройти регистрацию (см. раздел 2.1.1).
- Процесс оплаты: Оплата через СБП, После успешной оплаты деньги резервируются на счёте клиента, После оплаты → экран подтверждения

**Подтверждение заказа:**
- Экран "Ваш заказ": Список заказанных продуктов, Текст "Примерное время доставки: 2 часа"

**Подтверждение доставки:**
- После доставки: Уведомление "Ваш заказ доставлен", Список заказанных продуктов, Рейтинг доставки (5 звёзд), Возможность поставить оценку

#### 2.1.7. Дневник подопечного

**Доступ:**
- Доступен в личном кабинете в разделе "Дневники подопечных"
- Данные синхронизируются с приложением специалиста и организаций в реальном времени
- Если клиента пригласила сиделка или организация передала доступ к дневнику, клиент видит дневник и маршрутный лист

**Структура дневника:**

**Блок 1: Параметры ухода (9 параметров)**
1. Прогулка — время начала и окончания
2. Когнитивные игры — выбор из списка (шахматы, чтение, интересный разговор, настольные игры) или свой вариант
3. Смена подгузников — время смены
4. Гигиена — время проведения
5. Увлажнение кожи — время проведения
6. Приём пищи — время приёма
7. Приём лекарств — список лекарств, время приёма (лекарства запоминаются)
8. Приём витаминов — список витаминов, время приёма (витамины запоминаются)
9. Сон — время сна

**Блок 2: Физикальные параметры (6 параметров)**
1. Температура — значение, время замера
2. Артериальное давление — значение АД, время измерения
3. Частота дыхания — значение, время замера
4. Уровень боли — уровень 0-10, время фиксации, комментарий
5. Сатурация — значение, время измерения
6. Уровень сахара в крови — значение, время измерения

**Блок 3: Выделение мочи и кала (2 параметра)**
1. Выпито/выделено и цвет мочи — количество выпитой воды (мл), количество выделенной мочи (мл), цвет мочи
2. Дефекация — было/не было

**Блок 4: Тягостные симптомы (8 параметров)**
Все параметры: выбор "было/не было", автоматическая фиксация времени при сохранении
1. Тошнота
2. Рвота
3. Одышка
4. Зуд
5. Кашель
6. Сухость во рту
7. Икота
8. Нарушение вкуса

**Подсказки по параметрам:**
Кнопки с подсказками для следующих параметров:
- Артериальное давление: Измерение АД ручным тонометром, Измерение АД автоматическим тонометром
- Температура: Измерение температуры спиртовым термометром
- Частота дыхания: Как измерить частоту дыхательных движений
- Уровень боли: Алгоритм оценки боли
- Сатурация: Измерение сатурации
- Уровень сахара: Измерение сахара в крови с помощью домашнего глюкомера
- Выпито/выделено: Как померить диурез
- Тошнота: Помощь при тошноте
- Рвота: Помощь при рвоте
- Одышка: Помощь при одышке
- Зуд: Помощь при зуде
- Кашель: Помощь при кашле
- Сухость во рту: Помощь при сухости во рту
- Икота: Помощь при икоте
- Нарушение вкуса: Помощь при нарушении вкуса

**Графики динамики:**
- Вывод графика по всем заполненным параметрам (по выбору)
- Визуализация изменения состояния подопечного по конкретным показателям

**Будильники:**
- **Будильник приёма лекарств:** Указать лекарства, Установить время приёма для каждого лекарства, Push-уведомления в установленное время
- **Будильник приёма витаминов:** Аналогично лекарствам

**Закрепленные показатели с таймером:**
- Возможность закрепить показатели для регулярного заполнения с напоминаниями
- Отображаются на главном экране с таймером
- При истечении таймера — push-уведомление
- Последнее заполненное значение отображается в круге
- Отслеживание динамики заполненных закрепленных показателей с ИИ оценкой, которая выводится в самом показателе, когда он в открытом состоянии

**Дополнительные функции:**
- История заполнения: просмотр всех записей по датам через календарь
- Медиафайлы: возможность прикреплять фото и видео к показателям (при заполнении)
- Экспорт отчётов: генерация PDF/CSV отчётов для передачи врачу
- Отслеживание, кто заполнил параметр (клиент/сиделка/организация)

#### 2.1.8. Маршрутный лист - четкий план с задачами на день/неделю, которые должна выполнять сиделка

**Создание маршрутного листа:**

**Кто может создавать:**
- **Клиент** — может создавать маршрутный лист для частной сиделки (если клиента пригласила сиделка)
- **Клиент** — может создавать маршрутный лист, если организация передала доступ к дневнику
- **Клиент** — может передать доступ к дневнику врачу, чтобы врач мог создать маршрутный лист для сиделки
- Маршрутный лист доступен в разделе дневника подопечного

**Процесс создания:**
1. Выбор подопечного (из списка подопечных)
2. Выбор даты или создание шаблона на неделю
3. Создание задач:
   - Выбор манипуляций из карточки подопечного (измерение давления, прием лекарств, гигиена, прием пищи, измерение температуры, смена подгузников и т.д.)
   - Или создание произвольной задачи (пользователь вводит название задачи вручную)

4. **Настройка задачи:**
   - Название задачи (автоматически заполняется при выборе манипуляции)
   - **Время выполнения:**
     - Можно выбрать несколько временных диапазонов для одной задачи
     - Каждый диапазон: время начала и окончания (например: 08:00-08:30, 14:00-14:30, 20:00-20:30)
     - Пример: "Смена подгузников" может быть назначена на 08:00-08:30, 14:00-14:30, 20:00-20:30
     - Добавление дополнительного временного диапазона
   - **Дни недели:**
     - Выбор дней недели, когда задача должна выполняться (понедельник, вторник, среда и т.д.)
     - Можно выбрать несколько дней
     - При создании шаблона задача автоматически создается на каждый выбранный день недели
   - Задача видна сиделке, добавленной к дневнику

**Интерфейс маршрутного листа (функционвл похожий на гугл календарь):**
- Вертикальный список с временем сверху вниз (06:00, 07:00, 08:00... 23:00)
- Задачи отображаются плашками (карточками) под соответствующим временем
- Если у задачи несколько временных диапазонов, она отображается в каждом соответствующем временном слоте
- Индикация статуса на плашках: Не выполнено, Выполнено, Перенесено, Просрочено

**Структура плашки задачи:**
- Название задачи
- Время выполнения (диапазон)
- Подопечный (имя)
- Статус выполнения

**Интерактивность плашек:**
- Плашки можно перетаскивать пальцем (drag and drop) для переноса задачи на другое время
- При перетаскивании показывается индикатор целевого временного слота
- При отпускании плашки в новом временном слоте открывается форма для подтверждения переноса с обязательным указанием причины

**Выполнение задач сиделкой:**

**Функционал для сиделки:**
- Сиделка видит все задачи назначенного ей дневника в вертикальном списке
- Сиделка получает уведомления: О назначенной задаче, За 15 минут до времени начала, В назначенное время

**Отметка выполнения задачи:**
- Сиделка нажимает на плашку задачи в вертикальном списке
- Открывается модальное окно с деталями задачи
- Выбор статуса:
  - **Выполнено:**
    - Обязательно: отметка времени выполнения (автоматически фиксируется при нажатии)
    - Опционально: комментарий (текстовое поле)
    - Опционально: прикрепление фото
    - Автоматически: запись добавляется в историю дневника подопечного
    - Задача помечается как выполненная
  - **Не выполнено:**
    - Обязательно: указание причины невыполнения (текстовое поле)
    - Причины могут быть разные (например: "У подопечного была температура, гигиена не проводилась")
    - Задача помечается как не выполненная
    - Причина сохраняется в истории
  - **Перенос задачи:**
    - Если сиделка не успела выполнить задачу в назначенное время, она может перенести её
    - **Способ 1:** Перетаскивание плашки пальцем в нужный временной слот (drag and drop)
    - **Способ 2:** Через модальное окно (нажатие на плашку → "Перенести задачу" → выбор времени)
    - Обязательное указание причины переноса (текстовое поле)
    - Задача перемещается в новый временной слот в вертикальном списке
    - Задача помечается как перенесенная

**Шаблоны задач:**
- При создании задачи можно указать дни недели (понедельник, вторник, среда и т.д.)
- Задача автоматически создается на каждый указанный день недели с указанными временными диапазонами
- Не нужно создавать задачу отдельно на каждый день
- Можно редактировать/удалять шаблон, изменения применяются ко всем дням недели
- Пример: "Смена подгузников" на понедельник, среду, пятницу в 08:00-08:30, 14:00-14:30, 20:00-20:30 → автоматически создается на эти дни каждую неделю с тремя временными диапазонами

**История выполнения:**
- Клиент видит историю выполнения всех задач
- Фильтрация по датам, статусу выполнения
- Просмотр комментариев и фото к выполненным задачам
- Просмотр причин невыполнения и переноса задач

#### 2.1.9. Карточка подопечного

**Отдельная сущность, не привязанная напрямую к дневнику**

**Личные данные:**
- ФИО (обязательно)
- Дата рождения (опционально)
- Рост (опционально)
- Вес (опционально)
- Пол (обязательно)

**Диагнозы:**
- Выбор из списка: Перелом шейки бедра, Инфаркт, Альцгеймер, Инсульт, Паркинсон, Деменция
- Возможность добавить пользовательский диагноз
- Можно выбрать несколько диагнозов

**Мобильность:**
- Выбор одного варианта: ходит, сидит, лежит

**Требуемые услуги:**
- Множественный выбор из списка:
  - Растирание конечностей
  - Развивающие игры
  - Интересное времяпрепровождение
  - Проследить за принятием лекарств
  - Помощь в кормлении
  - Мерять давление
  - Уборка
  - Стирка
  - Готовка
  - Гигиенический уход (помощь в смене памперсов, абсорбирующее бельё, использование и очистка судна, кресло туалета)
- Можно выбрать несколько услуг
- Можно добавить пользовательскую услугу не из списка
- Требуемые услуги используются для подбора подходящего специалиста при заказе через Heal Link

**Важно:**
- Карточка должна быть создана ДО создания дневника
- У одного подопечного только одна карточка
- Клиент — владелец карточки и дневника

---

### 2.2. Мобильное приложение для специалистов (iOS/Android)

#### 2.2.1. Регистрация и авторизация

**Регистрация:**
- Регистрация по номеру телефона и паролю
- Проверка телефона: отправка кода подтверждения на номер телефона
- Ввод кода подтверждения для верификации телефона
- Установка пароля
- **Выбор типа регистрации:**
  - Частный специалист
  - Организация (Пансионат / Патронажное агентство)
- После выбора типа → минимальное заполнение профиля:
  - **Для частных специалистов:** Имя (обязательно), Фамилия (обязательно)
  - **Для организаций:** Название организации (обязательно), Номер телефона (обязательно) — с подписью что это для связи с поддержкой в WhatsApp, Адрес (обязательно) — место нахождения организации
- После минимального заполнения профиля пользователь получает доступ к приложению

**Авторизация:**
- Вход по номеру телефона и паролю
- Восстановление пароля через SMS

#### 2.2.2. Заполнение профиля

**Примечание:** Процесс заполнения профиля различается в зависимости от выбранного типа регистрации (частный специалист или организация).

**Для частных специалистов:**

**Выбор типа работы:**
Варианты (можно выбрать несколько):
- Сиделка почасовая/с проживанием
- Медперсонал
- Компаньон (подходит волонтёрам)

**Профиль для сиделки (если выбрана сиделка или сиделка + другое):**

**Обязательные поля:**
- Фото профиля
- Возраст
- Работали ли с лежачими (да/нет)
  - Если "да" → выбор количества часов: Меньше 100, Больше 100, Больше 300, Больше 500, Больше 1000
- С какими больными работали (множественный выбор): Болезнь Паркинсона, Болезнь Альцгеймера, Деменция, Инсульт, Инфаркт, Перелом шейки бедра, Онкология, Свой вариант
- Дополнительные умения (текстовое поле): уборка, готовка, умение ставить капельницу
- Медицинское образование (да/нет):
  - Если "нет" и выбрана работа медперсоналом → предупреждение: "Без медобразования нельзя работать медперсоналом, только сиделкой или компаньоном"
  - Если "да" → прикрепить документ, подтверждающий образование
- Основное место работы (один вариант): Есть постоянное место работы, Есть подработка, Нет постоянного места работы
- Предыдущие места работы (текстовое поле)
- Районы работы в Москве (множественный выбор): Список всех районов Москвы, Поиск по районам, Подсказка: "Чем больше выберете, тем больше заказов будет"

**Настройка услуг:**
- Добавление услуги
- **Почасовой уход:** Указать стоимость часа, Выбрать что входит в час работы (чекбоксы): Уборка, Готовка, Помощь в кормлении, Стирка, Глажка, Специальная гимнастика, Когнитивные игры, Гигиена, Свой вариант
- **Уход с проживанием:** Указать стоимость месяца, Выбрать что входит (аналогично почасовому)
- **Дополнительные услуги (оплачиваются отдельно):**
  - Если есть медобразование, доступны: Поставить капельницу, Поставить укол, Провести осмотр, Лечение пролежней, Сделать перевязку (указать цену для каждой)
  - Для всех: Свой вариант (указать название и цену)

**Профиль для медсестры (если выбрана только медсестра):**

**Обязательные поля:**
- Фото профиля
- Возраст
- Прикрепить документ, подтверждающий медицинское образование
- Какие умения есть (текстовое поле)
- Работает сейчас / Не работает / Есть подработка
- Предыдущие места работы
- Районы работы в Москве (множественный выбор)

**Дополнительные услуги:**
- Поставить капельницу, Поставить укол, Взять кровь на анализы, Взять мочу/кал на анализы, Лечение пролежней, Медицинский осмотр (указать стоимость для каждой)
- Свой вариант (указать название и стоимость)

**Профиль для компаньона (если выбран только компаньон):**

**Обязательные поля:**
- ФИО
- Возраст
- Чем может быть полезен (множественный выбор): Вынесу мусор, Помогу убраться в квартире, Помогу приготовить еду, Поиграю в шахматы, Прочитаю книгу, Интересная беседа, Схожу в магазин
- Районы работы (множественный выбор)
- Предыдущие места работы
- Основное место работы / Подработка / Нет
- Стоимость часа работы (обычно 100-300 руб.)

**Видео-презентация:**
- После сохранения профиля → запись видео-кружка
- Возможность записать прямо в приложении (использование камеры)
- Предпросмотр записи перед сохранением
- Возможность перезаписать видео
- Текстовый пример для чтения (отображается на экране записи):

**Для сиделки:**
"Здравствуйте, меня зовут [Имя], мне [Возраст] лет. Я работала с лежачими подопечными [количество часов, если работала]. Также работала с больными [список диагнозов]. Буду рада поработать с вашим подопечным."

**Для медперсонала:**
"Здравствуйте, меня зовут [Имя], мне [Возраст] лет. Я имею [стаж] лет стажа, работала в [места работы]. Готова приехать к вам и сделать услуги: [примеры услуг, например: укол, капельницу]."

**Для компаньона:**
"Здравствуйте, меня зовут [Имя], мне [Возраст] лет. Мой опыт работы [описание]. Могу помочь [в зависимости от выбранных услуг]. Готов приехать к вам и помочь."

**Календарь работы:**
- Календарный интерфейс (месячный вид)
- Выбор дней, когда специалист может работать (отметка дней)
- Для каждого выбранного дня: Выбор времени начала работы, Выбор времени окончания работы, Возможность выбрать несколько временных слотов в один день
- Минимум: один месяц (обязательно заполнить минимум 30 дней)
- Возможность скопировать график на следующий месяц
- Создание графика (сохранение и активация профиля)
- После создания графика специалист получает доступ к входящим заказам

**Для организаций:**

**Заполнение профиля организации:**
- Название организации (обязательно)
- Номер телефона (обязательно, для связи с поддержкой в WhatsApp)
- Адрес организации (обязательно, место нахождения организации)
- После заполнения профиля → доступ к функционалу организации (управление сотрудниками, маршрутные листы, дневники подопечных)

#### 2.2.3. Главный экран специалиста

**Входящие заказы:**

**Экран с заказами от клиентов:**

**Информация о заказе:**
- Имя клиента
- Возраст подопечного
- Болезни подопечного (список)
- Мобильность (лежачий/сидячий/ходячий)
- Какая услуга требуется (почасовая/с проживанием/медсестра/компаньон)
- Район (название района Москвы)
- Даты и время работы (список дат с временем)
- Ползунок: "Согласиться" / "Отказаться"
- При отказе → выбор причины отказа из списка: Занят в это время, Не подходит район, Не подходит тип услуги, Другая причина (текстовое поле)

**После согласия:**
- Возврат к списку заказов (возврат к списку заказов)
- Автоматическое резервирование дат и времени в календаре специалиста (блокировка этих слотов)
- Уведомление клиенту о согласии специалиста

#### 2.2.4. Личный кабинет специалиста

**Структура:**
- Имя специалиста и номер телефона
- Переход в настройки

**Текущие заказы:**
- Плашки с датами заказов
- При нажатии на дату → детальная информация

**Детальная информация о заказе:**
- Заголовок: "Посещение подопечного [Имя подопечного]"
- Дата и время посещения (полная информация)
- Описание клиента: Фото клиента (если есть), Имя клиента, Номер телефона клиента (для связи)
- Описание подопечного: Фото подопечного (если есть), Имя подопечного, Возраст подопечного, Информация о болезнях (список), Мобильность, Адрес посещения
- Оплаченные услуги (список с ценами)
- Дополнительные услуги (если были заказаны)
- Начало заказа (появляется в день посещения)
- Переход в чат с клиентом

**Дневник подопечного:**
- Доступен после начала работы (для сиделок)
- Структура дневника аналогична дневнику в приложении клиента (см. раздел 2.1.7)
- При выполнении задачи из маршрутного листа автоматически создается запись в дневнике

**Маршрутный лист (для частных сиделок):**
- Сиделка видит маршрутный лист, созданный клиентом для дневника подопечного
- Маршрутный лист отображается в вертикальном списке с временными слотами
- Сиделка получает уведомления: О назначенной задаче, За 15 минут до времени начала, В назначенное время

**Отметка выполнения задачи:**
- Сиделка нажимает на плашку задачи в вертикальном списке
- Открывается модальное окно с деталями задачи
- Выбор статуса:
  - **Выполнено:**
    - Обязательно: отметка времени выполнения (автоматически фиксируется при нажатии)
    - Опционально: комментарий (текстовое поле)
    - Опционально: прикрепление фото
    - Автоматически: запись добавляется в историю дневника подопечного
    - Задача помечается как выполненная
  - **Не выполнено:**
    - Обязательно: указание причины невыполнения (текстовое поле)
    - Причины могут быть разные (например: "У подопечного была температура, гигиена не проводилась")
    - Задача помечается как не выполненная
    - Причина сохраняется в истории
  - **Перенос задачи:**
    - Если сиделка не успела выполнить задачу в назначенное время, она может перенести её
    - **Способ 1:** Перетаскивание плашки пальцем в нужный временной слот (drag and drop)
    - **Способ 2:** Через модальное окно (нажатие на плашку → "Перенести задачу" → выбор времени)
    - Обязательное указание причины переноса (текстовое поле)
    - Задача перемещается в новый временной слот в вертикальном списке
    - Задача помечается как перенесенная

**Дополнительная информация:**
- Блок "Где нас найти": Ссылка на сайт, Ссылка на Telegram-канал
- Связь с поддержкой

**Настройки:**
- Изменение данных профиля (все поля, заполненные при регистрации)
- Уведомления: Push-уведомления, Письма на почту, SMS

#### 2.2.5. Процесс работы

**Начало работы:**
1. Специалист приходит к подопечному
2. В приложении находит дату и карточку клиента в личном кабинете
3. Нажимает "Начать заказ"
4. Клиенту отправляется push-уведомление: "Специалист начал выполнение работы"
5. Клиент должен подтвердить начало работы в своём приложении
6. После подтверждения:
   - Заказ переходит в статус "В работе"
   - Деньги остаются на счету клиента до завершения заказа
   - Для сиделок открывается доступ к дневнику подопечного (переход к дневнику появляется в детальной информации о заказе)
   - Уведомление специалисту: "Клиент подтвердил начало работы"

**Завершение работы:**
1. После выполнения работы специалист нажимает "Завершить заказ" в своём приложении
2. Клиенту отправляется push-уведомление: "Специалист завершил выполнение работы"
3. Клиент должен подтвердить завершение работы в своём приложении
4. После подтверждения:
   - Деньги списываются со счёта клиента
   - Деньги переводятся на счёт специалиста (счёт оказания услуг)
   - Заказ переходит в статус "Завершен"
   - Уведомление специалисту: "Клиент подтвердил завершение работы"

**Взаимодействие в чате:**

**Дополнительные услуги:**
- Если клиент запросил и оплатил доп. услуги:
  - В чате появляется: "Клиент оплатил дополнительную услугу(и): [список услуг]"

**Дозаказ часов:**
- Если клиент запросил дополнительные часы:
  - Сообщение: "Клиент хочет заказать дополнительные X часов работы за Y руб."
  - Кнопки: "Согласиться" / "Отказать"
  - При согласии: Сообщение "Ваши часы продлены", Средства зачисляются на баланс
  - При отказе: Клиент получает уведомление, Клиент может запустить поиск сменщицы

**Запрос отчёта:**
- Если клиент запросил заполнение дневника:
  - Сообщение: "Клиент запросил отчёт, заполните пожалуйста дневник подопечного и отправьте"
  - Заполнение дневника
  - После заполнения → отправка краткого отчёта клиенту

#### 2.2.6. Реферальная программа и кэшбек

**Реферальная программа для клиентов:**
- Специалист может пригласить клиента через реферальную ссылку
- Если приглашенный клиент покупает Vita Box:
  - Специалист получает **1000 руб.** на кэшбек-счёт за каждую покупку бокса клиентом
  - Бонус начисляется автоматически после подтверждения покупки клиентом

**Реферальная программа для специалистов:**
- Специалист может пригласить другого специалиста на платформу через реферальную ссылку
- Если приглашенный специалист совершает покупку Vita Box:
  - Пригласивший специалист получает **500 руб.** на кэшбек-счёт
- Если клиент, которого пригласил приглашенный специалист, покупает Vita Box:
  - Пригласивший специалист (первый в цепочке) получает **500 руб.** на кэшбек-счёт
  - Приглашенный специалист получает **1000 руб.** на кэшбек-счёт (за своего клиента)

**Личные покупки специалиста:**
- Если специалист покупает Vita Box:
  - Специалист получает **1000 руб.** на кэшбек-счёт

**Система счетов:**
- У специалиста два счёта:
  1. **Кэшбек-счёт** — для кэшбеков и бонусов от реферальной программы
  2. **Счёт оказания услуг** — для получения денег от работы с клиентами

**Реферальные ссылки:**
- В профиле специалиста доступны реферальные ссылки:
  - Ссылка для приглашения клиентов
  - Ссылка для приглашения других специалистов
  - Данные по реферальной системе и заработанным деньгам
- Ссылки можно копировать и отправлять клиентам/специалистам

---

#### 2.2.7. Функционал для организаций

**Примечание:** Организации (патронажные агентства и пансионаты) используют то же приложение, что и частные специалисты. При регистрации (см. раздел 2.2.1) выбирается тип: "Организация" и далее тип организации (Пансионат / Патронажное агентство). Заполнение профиля организации описано в разделе 2.2.2.

#### 2.2.7.1. Главный экран организации

**Элементы:**
- Сверху: название организации и переход в профиль
- Основной блок: список карточек подопечных организации
  - Отображение карточек подопечных с основной информацией (ФИО, диагнозы, мобильность)
  - При нажатии на карточку — переход к детальной информации о подопечном
  - Быстрый доступ к дневнику и маршрутному листу подопечного из карточки
- Кнопки быстрого доступа:
  - "Карточки подопечных" — управление карточками (создание, редактирование)
  - "Дневники подопечных" — просмотр всех дневников
  - "Маршрутные листы" — управление маршрутными листами
  - "Сотрудники" — управление сотрудниками
  - "Клиенты" — управление клиентами
  
#### 2.2.7.2. Управление сотрудниками

**Список сотрудников:**
- Отображение всех сотрудников организации
- Фильтрация по ролям (администратор, руководитель, врач, сиделка)
- Поиск по имени/фамилии
- Просмотр профиля сотрудника

**Приглашение сотрудников:**
- Создание пригласительной ссылки для сотрудника
- Выбор роли при создании ссылки:
  - **Администратор (`admin`)** — полный доступ: управление доступом, создание карточек и дневников, приглашение сотрудников и клиентов
  - **Руководитель (`manager`)** — управление доступом, создание карточек и дневников, приглашение сотрудников и клиентов
  - **Врач (`doctor`)** — просмотр и заполнение дневников, создание маршрутных листов (только для пансионатов)
  - **Сиделка (`caregiver`)** — только просмотр и заполнение дневников, выполнение задач из маршрутного листа
- Копирование ссылки для отправки сотруднику
- Просмотр статуса ссылки (активна/использована)

**Управление доступом к дневникам:**

**Для патронажных агентств:**
- По умолчанию сотрудники не имеют доступа ни к одному дневнику
- Доступ выдается вручную через назначение сотрудников к конкретным дневникам подопечных
- Сотрудник видит только назначенные ему дневники и маршрутные листы
- Управление доступом могут выполнять только администраторы и руководители организации
- Клиент может отозвать доступ у любого сотрудника

**Для пансионатов:**
- Все сотрудники автоматически видят все дневники организации
- Дополнительное назначение не требуется
- Доступ можно отозвать полностью (убрать организацию из дневника) — тогда все сотрудники теряют доступ
- Клиент может отозвать доступ у организации

**Права сотрудников по ролям:**

**Администратор (`admin`) и Руководитель (`manager`):**
- Создание и редактирование карточек подопечных
- Создание и редактирование дневников
- Управление доступом к дневникам (назначение/отзыв доступа у других сотрудников)
- Приглашение сотрудников и клиентов
- Создание и управление маршрутными листами
- Просмотр и заполнение дневников

**Врач (`doctor`):**
- Просмотр и заполнение дневников
- Создание маршрутных листов для сиделок
- Просмотр карточек подопечных (без возможности редактирования)
- Не может создавать карточки и дневники
- Не может управлять доступом

**Сиделка (`caregiver`):**
- Просмотр и заполнение дневников
- Выполнение задач из маршрутного листа
- Просмотр карточек подопечных (без возможности редактирования)
- Не может создавать карточки и дневники
- Не может управлять доступом
- Не может создавать маршрутные листы

#### 2.2.7.3. Маршрутный лист

**Создание маршрутного листа:**

**Кто может создавать:**
- Организация (администратор/руководитель/врач) — для подопечных организации
- Врач (если есть доступ к дневнику, только просмотр дневника, но может создавать маршрутный лист)
- **Клиент** — если организация передала доступ к дневнику, клиент также может создавать маршрутный лист
- **Клиент** — может передать доступ к дневнику врачу, чтобы врач мог создать маршрутный лист для сиделок

**Доступ к маршрутному листу:**
- Когда организация передает доступ к дневнику клиенту, клиент также видит маршрутный лист и может его создавать и редактировать
- Клиент видит все задачи, созданные организацией, и может создавать свои задачи

**Процесс создания:**
1. Выбор подопечного (из списка подопечных организации)
2. Выбор даты или создание шаблона на неделю
3. Создание задач:
   - Выбор манипуляций из карточки подопечного (измерение давления, прием лекарств, гигиена, прием пищи, измерение температуры, смена подгузников и т.д.)
   - Или создание произвольной задачи (пользователь вводит название задачи вручную)

4. **Настройка задачи:**
   - Название задачи (автоматически заполняется при выборе манипуляции)
   - **Время выполнения:**
     - Можно выбрать несколько временных диапазонов для одной задачи
     - Каждый диапазон: время начала и окончания (например: 08:00-08:30, 14:00-14:30, 20:00-20:30)
     - Добавление дополнительного временного диапазона
   - **Дни недели:**
     - Выбор дней недели, когда задача должна выполняться (понедельник, вторник, среда и т.д.)
     - Можно выбрать несколько дней
     - При создании шаблона задача автоматически создается на каждый выбранный день недели
   - **Для пансионатов:** выбор конкретного сотрудника из списка (для каждого временного диапазона можно назначить разных сотрудников)
   - **Для патронажных агентств:** задача видна всем сотрудникам, добавленным к дневнику

**Расписание пансионата:**

**Особенность для пансионатов:**
- Организация создает общее расписание пансионата (например: 07:00 - гигиенические процедуры, 08:00 - завтрак, 10:00-12:00 - медицинские процедуры, 14:00 - обед, 15:00-17:00 - развлечения)
- Это расписание автоматически применяется к маршрутному листу каждого подопечного
- Организация может дополнительно создавать индивидуальные задачи для конкретных подопечных
- При создании индивидуальной задачи:
  - Выбирается время выполнения (можно несколько диапазонов)
  - Выбираются дни недели
  - Показывается список сотрудников с указанием их занятости в это время (свободен/занят)
  - Можно назначить задачу только свободному сотруднику
  - Для каждого временного диапазона можно назначить разных сотрудников
- Одна задача не может быть назначена нескольким сотрудникам одновременно в одно и то же время
- **Каждый сотрудник видит свой персональный маршрутный лист** с задачами, которые ему назначили руководители

**Интерфейс маршрутного листа (вертикальный список):**

**Отображение:**
- Вертикальный список с временем сверху вниз (06:00, 07:00, 08:00, 09:00... 22:00, 23:00)
- Задачи отображаются плашками (карточками) под соответствующим временем
- Если у задачи несколько временных диапазонов, она отображается в каждом соответствующем временном слоте
- Индикация статуса на плашках: Не выполнено, Выполнено, Перенесено, Просрочено

**Структура плашки задачи:**
- Название задачи
- Время выполнения (диапазон)
- Подопечный (имя, для пансионатов: номер койки, номер палаты)
- Статус выполнения

**Интерактивность плашек:**
- Плашки можно перетаскивать пальцем (drag and drop) для переноса задачи на другое время
- При перетаскивании показывается индикатор целевого временного слота
- При отпускании плашки в новом временном слоте открывается модальное окно для подтверждения переноса

**Для патронажных агентств:**
- Сотрудник видит все задачи назначенного ему дневника в вертикальном списке
- Задачи не привязаны к конкретному сотруднику при создании
- Любой сотрудник, добавленный к дневнику, может выполнить задачу

**Для пансионатов:**
- При создании задачи показывается список сотрудников
- Отображается статус занятости каждого сотрудника в это время (свободен/занят)
- Можно назначить задачу только свободному сотруднику
- **У каждого сотрудника свой персональный маршрутный лист**, где он видит только задачи, которые ему назначили руководители на сегодня
- Сотрудник видит задачи в вертикальном списке, отсортированные по времени
- В маршрутном листе сотрудника отображается: Название задачи, Время выполнения (диапазон), Подопечный (имя, номер койки, номер палаты), Статус выполнения

**Выполнение задач сотрудником:**

**Процесс:**
1. Сотрудник получает уведомление о назначенной задаче
2. За 15 минут до времени начала → уведомление о скором начале выполнения
3. В назначенное время → уведомление о необходимости начать выполнение
4. Сотрудник нажимает на плашку задачи в вертикальном списке (или перетаскивает плашку для переноса)
5. Открывается модальное окно с деталями задачи
6. Выбор статуса:
   - **Выполнено:**
     - Обязательно: отметка времени выполнения (автоматически во время выбора статуса)
     - Опционально: комментарий
     - Опционально: прикрепление фото
     - Автоматически: запись добавляется в историю дневника подопечного
   - **Не выполнено:**
     - Обязательно: указание причины невыполнения (текстовое поле)
     - Причины могут быть разные (например: "У подопечного была температура, гигиена не проводилась")
     - Задача помечается как не выполненная
     - Причина сохраняется в истории

**Перенос задачи:**
- Если сотрудник не успел выполнить задачу в назначенное время, он может перенести её
- **Способ переноса:**
  1. **Перетаскивание плашки (drag and drop):**
     - Сотрудник зажимает плашку с задачей пальцем
     - Перетаскивает плашку в нужный временной слот в вертикальном списке
     - При перетаскивании показывается индикатор целевого временного слота
     - При отпускании плашки открывается модальное окно для подтверждения переноса
     - Обязательное указание причины переноса (текстовое поле)
     - После подтверждения задача перемещается в новый временной слот
  2. **Через модальное окно:**
     - Нажатие на плашку задачи
     - Выбор опции "Перенести задачу"
     - Выбор нового времени выполнения (из доступных временных слотов)
     - Обязательное указание причины переноса (текстовое поле)
     - Задача перемещается в новый временной слот в вертикальном списке
- После переноса:
  - Уведомление организации о переносе (если уведомления не отключены)
  - Задача помечается как перенесенная
  - Причина переноса сохраняется в истории

#### 2.2.7.4. Шаблоны задач

**Создание шаблона:**
- При создании задачи **обязательно** указываются:
  - Время выполнения (один или несколько диапазонов)
  - Дни недели (понедельник, вторник, среда и т.д.)
- Задача автоматически создается на каждый указанный день недели с указанными временными диапазонами
- Не нужно создавать задачу отдельно на каждый день
- Пример: "Смена подгузников" на понедельник, среду, пятницу в 08:00-08:30, 14:00-14:30, 20:00-20:30 → автоматически создается на эти дни каждую неделю с тремя временными диапазонами

**Редактирование шаблона:**
- Можно редактировать/удалять шаблон
- Изменения применяются ко всем дням недели, на которые назначена задача
- Можно изменить время выполнения, дни недели, назначенного сотрудника (для пансионатов)

#### 2.2.7.5. Уведомления

**Для сотрудников:**
- Уведомление о назначенной задаче (сразу после создания организацией)
- За 15 минут до времени начала → уведомление о скором начале выполнения
- В назначенное время → уведомление о необходимости начать выполнение
- Уведомление о переносе задачи (если задача была перенесена другим сотрудником или организацией)

**Для организаций:**
- Уведомление о выполнении задачи сотрудником (опционально, можно отключить)
- Уведомление о переносе задачи сотрудником (опционально, можно отключить)
- Уведомление о невыполнении задачи (опционально, можно отключить)
- Уведомление о просроченных задачах (если задача не выполнена в назначенное время)

#### 2.2.7.6. Дневники подопечных

**Создание карточки подопечного и дневника:**
- Администратор/врач/руководитель организации создаёт карточку подопечного (от имени клиента)
- После создания карточки организация создаёт дневник на основе карточки
- Карточка и дневник создаются до приглашения клиента
- Клиент станет владельцем карточки и дневника после регистрации по приглашению

**Приглашение клиента в дневник:**
- После создания дневника организация может пригласить клиента
- Приглашение привязано к конкретной карточке подопечного и дневнику
- **Способы создания приглашения:**
  1. **В настройках дневника (вкладка "Доступ для клиента")** — основной способ
  2. **В настройках карточки подопечного (кнопка "Пригласить клиента")** — опционально
- Создание пригласительной ссылки для клиента
- Копирование ссылки для отправки клиенту (WhatsApp, Телеграм, Макс и др.)
- После создания дневника ссылка на приглашение клиента всегда доступна в дневнике (вкладка "Доступ для клиента")

**Процесс регистрации клиента:**
- Клиент переходит по пригласительной ссылке
- Регистрация по номеру телефона и паролю
- Проверка телефона: отправка кода подтверждения на номер телефона
- Ввод кода подтверждения для верификации телефона
- Установка пароля
- При регистрации автоматически привязывается к организации, карточке подопечного и дневнику
- Клиент заполняет свой профиль (имя, фамилия — телефон уже известен из регистрации)
- После регистрации клиент становится владельцем карточки и дневника

**Доступ к дневникам:**
- Организация имеет доступ ко всем дневникам подопечных организации
- Структура дневника аналогична дневнику в приложении клиента (см. раздел 2.1.7)
- При выполнении задачи из маршрутного листа автоматически создается запись в дневнике

**Права доступа:**
- **Клиент:** полный доступ (владелец), может редактировать карточку, просматривать дневник, создавать и управлять маршрутным листом, управлять доступом организации
- **Клиент:** может передать доступ к дневнику врачу (только просмотр дневника, но может создавать маршрутный лист для сиделок)
- **Организация (администратор/врач/руководитель):** полный доступ (доступ может быть отозван клиентом), может создавать маршрутные листы
- **Сотрудники организации (сиделки):** только заполнение и просмотр дневника (не карточки, доступ может быть отозван клиентом), выполнение задач из маршрутного листа
- Клиент может отозвать доступ у организации — тогда все сотрудники теряют доступ к дневнику
- Карточка и дневник остаются у клиента навсегда, даже если доступ организации отозван
- **Доступ к маршрутному листу:** когда организация передает доступ к дневнику клиенту, клиент также видит маршрутный лист и может его создавать и редактировать

**Просмотр истории:**
- Просмотр всех записей дневника по датам через календарь
- Фильтрация записей по типам показателей, автору (кто заполнил)
- Просмотр графиков динамики показателей
- Экспорт отчётов (PDF/CSV) для передачи врачам или в контролирующие органы

**Управление доступом сотрудников:**
- Для патронажных агентств: назначение сотрудников к конкретным дневникам
- Для пансионатов: все сотрудники автоматически видят все дневники организации
- Возможность предоставить доступ врачу (только просмотр дневника, но может создавать маршрутный лист)
- Клиент может передать доступ к дневнику врачу для создания маршрутного листа (врач получает только просмотр дневника, но может создавать маршрутный лист)

#### 2.2.7.7. Личный кабинет организации

**Структура:**
- Название организации и контактные данные (вверху экрана)
- Переход в настройки

**Блоки:**
- **Сотрудники:** Управление сотрудниками, просмотр их профилей, назначение ролей
- **Дневники подопечных:** Быстрый доступ ко всем дневникам
- **Маршрутные листы:** Просмотр всех маршрутных листов, создание новых
- **Расписание:** Только для пансионатов — общее расписание пансионата
- **Клиенты:** Список клиентов, которым был выдан доступ к дневникам подопечных

**Настройки:**
- Изменение данных профиля организации (название, телефон, адрес)
- Управление уведомлениями (Push-уведомления, Письма на почту, SMS)
- Управление доступом сотрудников
- Настройки расписания (для пансионатов)

---

## 3. Технические требования

### 3.1. Архитектура приложения

**Кроссплатформенная разработка:**
- React Native или Flutter
- Единая кодовая база для iOS и Android
- Нативные модули для специфичных функций (платежи, уведомления)

**Backend:**
- Supabase (PostgreSQL, Auth, Storage, Realtime)
- Edge Functions для бизнес-логики
- Row Level Security (RLS) для контроля доступа к данным

### 3.2. Управление состоянием

- React Query / TanStack Query для серверного состояния и кэширования
- Zustand или Redux Toolkit для клиентского состояния
- Оптимистичные обновления для улучшения UX

### 3.3. Формы и валидация

- React Hook Form для управления формами
- Zod для валидации схем
- Автосохранение форм (draft)

### 3.4. Платежи

- Интеграция с СБП (Система быстрых платежей)
- Интеграция с Сбер ID (опционально)
- Безопасное хранение платежных данных
- Двухэтапная оплата: зачисление на счёт клиента → списание после начала работы

### 3.5. Уведомления

- Push-уведомления (Firebase Cloud Messaging для Android, APNs для iOS)
- SMS-уведомления (через внешний сервис)
- Email-уведомления
- In-app уведомления

### 3.6. Геолокация

- Yandex Maps API или Google Maps API
- Определение местоположения для подбора специалистов по районам
- Отображение адресов на карте

### 3.7. Медиафайлы

- Загрузка фото и видео в Supabase Storage
- Оптимизация изображений перед загрузкой
- Голосовые заметки (запись и воспроизведение)

### 3.8. Синхронизация данных

- Realtime синхронизация через Supabase Realtime
- Офлайн-режим: просмотр кэшированных данных без интернета
- Автоматическая синхронизация при восстановлении соединения

### 3.9. Производительность

- Ленивая загрузка (lazy loading) для списков
- Оптимизация изображений
- Кэширование данных
- Минимизация количества запросов к серверу

### 3.10. Безопасность

- Шифрование данных при передаче (HTTPS)
- Аутентификация через Supabase Auth
- Row Level Security для контроля доступа
- Валидация всех пользовательских данных
- Защита от SQL-инъекций и XSS

---

## 4. UI/UX требования

### 4.1. Общие принципы

- **Mobile-first:** Интерфейс оптимизирован для мобильных устройств
- **Адаптивность:** Поддержка планшетов
- **Доступность:** Соответствие стандартам доступности (WCAG)
- **Интуитивность:** Понятный интерфейс без обучения
- **Отзывчивость:** Быстрая реакция на действия пользователя

### 4.2. Навигация

- Хлебные крошки для глубокой навигации
- Возврат к предыдущему экрану по стрелке
- Swipe-жесты для возврата (iOS)

### 4.3. Формы

- Автосохранение черновиков
- Валидация в реальном времени
- Понятные сообщения об ошибках
- Подсказки для заполнения полей
- Прогресс-индикаторы для многошаговых форм

### 4.4. Списки и карточки

- Pull-to-refresh для обновления списков
- Бесконечная прокрутка (infinite scroll) или пагинация
- Скелетоны загрузки вместо спиннеров
- Пустые состояния с подсказками

### 4.5. Обратная связь

- Toast-уведомления для успешных действий
- Модальные окна для важных подтверждений
- Обратная связь при действиях пользователя
- Анимации переходов между экранами
- Индикаторы загрузки для долгих операций

### 4.6. Обработка ошибок

- Понятные сообщения об ошибках
- Возможность повторить действие при ошибках сети
- Graceful degradation при отсутствии интернета
- Логирование ошибок для отладки

---

## 5. Тестирование

### 5.1. Типы тестирования

- **Unit-тесты:** Тестирование отдельных компонентов и функций
- **Integration-тесты:** Тестирование взаимодействия компонентов
- **E2E-тесты:** Тестирование полных пользовательских сценариев
- **UI-тесты:** Тестирование пользовательского интерфейса на разных устройствах

### 5.2. Тестирование на устройствах

- iOS: iPhone (разные размеры экранов), iPad
- Android: Разные производители и версии ОС
- Разные размеры экранов
- Разные версии операционных систем

### 5.3. Тестирование производительности

- Время загрузки экранов
- Время отклика на действия пользователя
- Использование памяти
- Потребление батареи

---

## 6. Развертывание и поддержка

### 6.1. Публикация

- App Store (iOS)
- Google Play (Android)
- Поэтапный релиз (staged rollout)

### 6.2. Обновления

- Автоматические обновления через магазины приложений
- Принудительные обновления для критических исправлений
- Миграция данных при обновлениях

### 6.3. Мониторинг

- Отслеживание ошибок (Sentry или аналоги)
- Аналитика использования (Firebase Analytics или аналоги)
- Мониторинг производительности
- Отслеживание конверсий

### 6.4. Поддержка

- Встроенная форма обратной связи
- Связь с поддержкой через WhatsApp
- База знаний/FAQ
- Видео-инструкции

---

## 7. Дорожная карта разработки

### 7.1. Этап 1: Модуль дневника подопечного и маршрутного листа

**Основной функционал:**
- Регистрация и авторизация (клиенты, специалисты, организации)
- Карточки подопечных (создание, редактирование, просмотр)
- Дневник подопечного:
  - Все 4 блока показателей (Параметры ухода, Физикальные параметры, Выделение мочи и кала, Тягостные симптомы)
  - Индивидуальные наборы показателей для каждого подопечного
  - Заполнение показателей с прикреплением медиафайлов
  - История заполнения с календарем
  - Закрепленные показатели с таймерами
  - Графики динамики показателей
  - Экспорт отчётов (PDF/CSV)
- Маршрутный лист:
  - Создание задач из манипуляций карточки подопечного и произвольных задач
  - Вертикальный список с временными слотами
  - Несколько временных диапазонов для одной задачи
  - Шаблоны задач с повторением по дням недели
  - Выполнение задач с отметкой времени, комментариями и фото
  - Перенос задач (drag and drop или через модальное окно)
  - Уведомления о назначенных задачах
- Управление доступом:
  - Для частных сиделок и клиентов
  - Для организаций (пансионаты и патронажные агентства)
  - Управление сотрудниками с разными ролями
  - Назначение доступа к дневникам для патронажных агентств
- Синхронизация данных в реальном времени

**Для организаций:**
- Регистрация организаций (пансионаты и патронажные агентства)
- Управление сотрудниками с ролями (администратор, руководитель, врач, сиделка)
- Расписание пансионата (общее расписание, применяемое ко всем подопечным)
- Персональные маршрутные листы для сотрудников пансионатов
- Статистика и отчёты по выполнению задач

### 7.2. Этап 2: Модуль маркета (Vita Box)

**Основной функционал:**
- Каталог товаров:
  - Три варианта боксов (Vita Box для лежачих с памперсами M, L, XL)
  - Дополнительные опции (средства от пролежней)
  - Дополнительные товары для ухода
- Оформление заказа:
  - Добавление товаров в корзину
  - Оформление заказа с привязкой счёта СБП
  - Оплата через СБП
- Подтверждение доставки:
  - Уведомление о доставке
  - Оценка доставки
- Подборки (избранное):
  - Сохранение товаров для быстрого заказа
- История заказов:
  - Просмотр всех заказов Vita Box
  - Статусы доставки

**Реферальная программа:**
- Реферальные ссылки для специалистов
- Кэшбек за покупки клиентов и других специалистов
- Система кэшбек-счётов

### 7.3. Этап 3: Модуль сервиса для сиделок (Heal Link)

**Основной функционал:**
- Создание карточки подопечного при заказе:
  - Личные данные подопечного
  - Заболевания и мобильность
  - Требуемые услуги
  - Выбор типа специалиста (сиделка/компаньон-волонтёр)
- Поиск и подбор специалистов:
  - Алгоритм подбора на основе параметров
  - Отображение карточек специалистов
  - Профиль специалиста с детальной информацией
- Типы услуг:
  - Почасовая забота и уход
  - Уход с проживанием
  - Вызов медсестры на дом
  - Перевозка лежачих (специализированное такси)
- Профили специалистов:
  - Заполнение профиля (опционально, для работы через Heal Link)
  - Опыт работы, навыки, районы работы
  - Настройка услуг и цен
  - Видео-презентация
  - Календарь работы
- Чат со специалистом:
  - Обмен текстовыми сообщениями
  - Дозаказ часов
  - Дозаказ услуг
  - Запрос заполнения дневника
- Процесс работы:
  - Начало работы специалистом
  - Подтверждение начала работы клиентом
  - Завершение работы специалистом
  - Подтверждение завершения работы клиентом
  - Перевод денег специалисту после завершения
- Платежи:
  - Интеграция с СБП
  - Резервирование средств на счету клиента
  - Списание после завершения работы
- Личный кабинет клиента:
  - Предстоящие посещения
  - История заказов
  - Управление карточками подопечных
- Личный кабинет специалиста:
  - Входящие заказы
  - Текущие заказы
  - История работы
  - Реферальная программа

  Этап 4: Модуль сопутстсвующих сервисов

### 7.4. Этап 5: Полировка и оптимизация

- Оптимизация производительности
- Расширенная аналитика
- Улучшение UX/UI на основе обратной связи
- Дополнительные функции по запросам пользователей
- Тестирование и исправление ошибок

---

## 8. Глоссарий

- **Подопечный** — человек, за которым осуществляется уход
- **Карточка подопечного** — профиль подопечного с личными данными, диагнозами, требуемыми услугами
- **Дневник подопечного** — цифровой журнал для фиксации показателей здоровья и ухода
- **Маршрутный лист** — система управления задачами и манипуляциями для сиделок
- **Плашка задачи** — карточка задачи в маршрутном листе
- **Heal Link** — сервис поиска и заказа сиделок и мед персонала
- **Vita Box** — сервис заказа уходовых боксов и расходных материалов
- **СБП** — Система быстрых платежей
- **Пансионат** — организация для постоянного проживания подопечных
- **Патронажное агентство** — организация, предоставляющая услуги ухода на дому